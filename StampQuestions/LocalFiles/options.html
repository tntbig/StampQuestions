
<!doctype html>
<html>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <head>
            <title>Test city</title>
            <link rel="stylesheet" type="text/css" href="normalize.css"/>
            <link rel="stylesheet" type="text/css" href="skeleton.css"/>
            <script src="jpcities.js"></script>
            <script src="jobs.js"></script>
            <style>
                </style>
        </head>
        <body>
            <div>
                
                <h1 style="text-align:center;">Options</h1>
                <hr/>
                <table width="100%">
                    <!-- 職業、年代、性別、地域 -->
                    
                    <tr>
                        <td style="text-align:center;">職業</td>
                        <td><select name="job" id="job" style="width:100%;"></select></td>
                    </tr>
                    <tr>
                        <td style="text-align:center;">年代</td>
                        <td><input type="text" id="ageInput" style="width:100%;"/></td>
                    </tr>
                    <tr>
                        <td style="text-align:center;">性別</td>
                        <td>
                            <select name="gender" id="gender" style="width:100%;">
                                <option>男</option>
                                <option>女</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align:center;">地域</td>
                        <td><select name="state" id="state" style="width:100%;"></select></td>
                    </tr>
                    <tr>
                        <td style="text-align:center" colspan="2">
                            <input type="button" value="Submit" name="btnSubmit" onclick="callAct()" action="submit" />
                        </td>
                    </tr>
                </table>
                
                <script language="javascript">
                    populateStates("state");
                    jobSelect("job");
                    function callAct(){
                        var job = document.getElementById('job').value;
                        var age = document.getElementById('ageInput').value;
                        var gender = document.getElementById('gender').selectedIndex;
                        var city = document.getElementById('state').value;
                        if(!checkJobSelected(job)){
                            alert("Please select your Job");
                            return;
                        }
                        if(!validateAge(age)){
                            alert("Your age input must be number and less than 100");
                            return;
                        }
                        if(!checkCitySelected(city)){
                            alert("Please select your city");
                            return;
                        }
                        
                        var str = "callbacktomain:job="+job+"&age="+age+"&gender="+gender+"&city="+city;
                        window.location = str;
                    }
                
                function validateAge(ageInput){
                    var reg = new RegExp('^(0?[1-9]|[1-4][0-9]|99)$');
                    if(ageInput.length == 0){
                        return false;
                    }
                    if (!ageInput.match(reg)){
                        return false;
                    }
                    return true;
                }
                
                function checkJobSelected(jobInput){
                    if(jobInput.length == 0){
                        return false;
                    }
                    return true;
                }
                
                function checkCitySelected(cityInput){
                    if(cityInput.length == 0){
                        return false;
                    }
                    return true;
                }
                </script>
                <br/>
            </div>
        </body>